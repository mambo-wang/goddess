webpackJsonp([8],{HgtN:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("woOf"),i=e.n(s),l=e("8XaJ"),n=e("waGG"),c=e("M4fF"),o=e.n(c),r=e("Nuup"),d={created:function(){this.queryConfig()},data:function(){var t=this;return{formState:{},storageFormState:{},isCapacityGB:!0,data:{fileSystemPath:[],fileSystemPathDialog:[],fileSystemType:"ext4",quota:"",unit:"GB",capacity:"",capacityTB:""},storageFields:[{name:"quota",showName:this.$t("parameter.quota"),required:!0,type:"text",unit:"GB"}],units:{options:[{value:"GB"},{value:"TB"}]},selectPathData:{visible:!1,data:[],close:function(){t.selectPathData.visible=!1},confirm:function(){t.selectPathData.visible=!1,t.data.fileSystemPath=t.data.fileSystemPathDialog}},defaultProps:{children:"subDisks"}}},methods:{onSubmit:function(){var t=this;this.$httpMethods.configServer.modifyConfig(this.data).then(function(a){a&&a.status&&t.$notify({type:"success",name:t.$t("common.success"),message:t.$t("parameter.modifySuccess")})})},onStorageSubmit:function(){var t=this;this.$httpMethods.configServer.modifyQuota(this.data.quota).then(function(a){a&&200===a.status&&(t.queryConfig(),t.$notify({type:"success",title:t.$t("common.success"),message:t.$t("parameter.modifySuccess")}))})},getChangeSelectValue:function(){},selectPath:function(){var t=this;this.$httpMethods.configServer.queryDisks().then(function(a){a&&200===a.status&&(t.selectPathData.data=a.data.disks,t.data.fileSystemPathDialog=o.a.clone(t.data.fileSystemPath)||[],t.selectPathData.data.forEach(function(a){if(a.subDisks){var e=!0,s=!0;a.subDisks.forEach(function(a){t.data.fileSystemPathDialog.indexOf(a.path)>-1?a.isSelected=!0:a.isSelected=!1,a.isSelected?e=!1:s=!1}),a.isSelected=s,a.isIndeterminate=!s&&!e}else t.data.fileSystemPathDialog.indexOf(a.path)>-1?a.isSelected=!0:a.isSelected=!1}),t.selectPathData.visible=!0)})},queryConfig:function(){var t=this;this.$httpMethods.configServer.queryConfig().then(function(a){a&&200===a.status&&(t.data=i()(t.data,a.data,{fileSystemType:"ext4"}))})},getUnitValue:function(t){this.data.unit=t},firstPathChange:function(t){var a=this;if(t.isIndeterminate=!1,Object(r.b)(this.data.fileSystemPathDialog)||(this.data.fileSystemPathDialog=[]),t.subDisks)t.subDisks.forEach(function(e){if(t.isSelected&&!e.isSelected&&a.data.fileSystemPathDialog.push(e.path),!t.isSelected&&e.isSelected){var s=a.data.fileSystemPathDialog.indexOf(e.path);console.log(s),s>-1&&a.data.fileSystemPathDialog.splice(s,1)}e.isSelected=!!t.isSelected});else if(t.isSelected)this.data.fileSystemPathDialog.push(t.path);else{var e=this.data.fileSystemPathDialog.indexOf(t.path);e>-1&&this.data.fileSystemPathDialog.splice(e,1)}},childPathChange:function(t,a){var e=!0,s=!0;if(a.subDisks.forEach(function(t){t.isSelected?e=!1:s=!1}),a.isSelected=s,a.isIndeterminate=!s&&!e,t.isSelected)this.data.fileSystemPathDialog.push(t.path);else{var i=this.data.fileSystemPathDialog.indexOf(t.path);i>-1&&this.data.fileSystemPathDialog.splice(i,1)}},changeSelected:function(t){var a=this.selectPathData.data.indexOf(t);t.isOpen=!t.isOpen;var e=o.a.clone(this.selectPathData.data);e[a]=t,this.selectPathData.data=e}},computed:{formDisabled:function(){return this.formState.$invalid},storageFormDisabled:function(){return this.storageFormState.$invalid},formatCapacity:function(){return"GB"===this.data.unit?this.data.capacity:this.data.capacity/1024}},watch:{"data.unit":function(t){"GB"===t&&(this.isCapacityGB=!0,(this.data.capacity/1024).toFixed(1)!==this.data.capacityTB&&(this.data.capacity=1024*this.data.capacityTB));if("TB"===t){this.isCapacityGB=!1;var a=(this.data.capacity/1024).toFixed(1);a!==this.data.capacityTB&&(this.data.capacityTB=this.data.capacity%1024==0?this.data.capacity/1024:a)}}},components:{selectArea:l.a,tipDialog:n.a}},p={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"h-full"},[e("div",{staticClass:"panel-nav"},[e("el-breadcrumb",{staticClass:"m-l-lg",attrs:{separator:"/"}},[e("el-breadcrumb-item",[t._v("\n            "+t._s(t.$t("parameter.title"))+"\n            ")])],1)],1),t._v(" "),e("div",{staticClass:"panel-body-list clearfix"},[e("section",{staticClass:"m-t-sm"},[e("header",[t._v(t._s(t.$t("parameter.initDeploy")))]),t._v(" "),e("span",{staticClass:"tip-info"},[t._v(t._s(t.$t("parameter.initInfo")))]),t._v(" "),e("vue-form",{key:"init",staticClass:"parameter-form",attrs:{state:t.formState},on:{submit:function(a){a.preventDefault(),t.onSubmit(a)}}},[e("validate",{key:"fileSystemPath",staticClass:"m-b-md clearfix",attrs:{tag:"div"}},[e("div",{staticClass:"pull-left"},[e("label",{staticClass:"required",domProps:{textContent:t._s(t.$t("parameter.path"))}})]),t._v(" "),e("div",{staticClass:"pull-left parameter-input m-l-lg"},[e("div",{staticClass:"parameter-textarea"},[t._l(t.data.fileSystemPath,function(a){return e("span",{key:a},[t._v(t._s(a)),e("br")])}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.fileSystemPath,expression:"data.fileSystemPath"}],attrs:{type:"hidden",name:"fileSystemPath",required:""},domProps:{value:t.data.fileSystemPath},on:{input:function(a){a.target.composing||t.$set(t.data,"fileSystemPath",a.target.value)}}})],2)]),t._v(" "),e("div",{staticClass:"parameter-select-btn"},[e("button",{attrs:{type:"button"},on:{click:t.selectPath}},[t._v(t._s(t.$t("parameter.selectPath")))])])]),t._v(" "),e("validate",{key:"capacity",staticClass:"m-b-md clearfix",attrs:{tag:"div"}},[e("div",{staticClass:"pull-left"},[e("label",{staticClass:"required",domProps:{textContent:t._s(t.$t("parameter.capacity"))}})]),t._v(" "),e("div",{staticClass:"pull-left parameter-input m-l-lg",staticStyle:{"font-size":"0"}},[t.isCapacityGB?e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.capacity,expression:"data.capacity"}],attrs:{type:"text",name:"capacity",required:!0},domProps:{value:t.data.capacity},on:{input:function(a){a.target.composing||t.$set(t.data,"capacity",a.target.value)}}}):t._e(),t._v(" "),t.isCapacityGB?t._e():e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.capacityTB,expression:"data.capacityTB"}],attrs:{type:"text",name:"capacity",required:!0},domProps:{value:t.data.capacityTB},on:{input:function(a){a.target.composing||t.$set(t.data,"capacityTB",a.target.value)}}}),t._v(" "),e("select-area",{staticClass:"select-unit",attrs:{options:t.units.options},on:{getSelectValue:t.getUnitValue},model:{value:t.data.unit,callback:function(a){t.$set(t.data,"unit",a)},expression:"data.unit"}})],1)]),t._v(" "),e("button",{staticClass:"btn btn-transform btn-apply-size",attrs:{disabled:t.formDisabled}},[t._v(t._s(t.$t("parameter.apply")))])],1)],1),t._v(" "),e("section",{staticClass:"m-t-lg"},[e("header",[t._v(t._s(t.$t("parameter.personalStorage")))]),t._v(" "),e("span",{staticClass:"tip-info"},[t._v(t._s(t.$t("parameter.storageInfo")))]),t._v(" "),e("vue-form",{key:"storage",staticClass:"parameter-form",attrs:{state:t.storageFormState},on:{submit:function(a){a.preventDefault(),t.onStorageSubmit(a)}}},[t._l(t.storageFields,function(a){return e("validate",{key:a.name,staticClass:"m-b-md clearfix",attrs:{tag:"div"}},[e("div",{staticClass:"pull-left"},[e("label",{class:a.required?"required":"",domProps:{textContent:t._s(a.showName)}})]),t._v(" "),e("div",{staticClass:"pull-left parameter-input m-l-lg"},["select"===a.type?e("select-area",{attrs:{placeholder:a.placeholder,name:a.name,options:a.options,value:t.data[a.name],required:!0},on:{getSelectValue:t.getChangeSelectValue}}):t._e(),t._v(" "),"text"===a.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.name],expression:"data[row.name]"}],attrs:{type:"text",name:a.name,placeholder:a.placeholder,required:!0},domProps:{value:t.data[a.name]},on:{input:function(e){e.target.composing||t.$set(t.data,a.name,e.target.value)}}}):t._e(),t._v(" "),a.unit?e("span",[t._v(t._s(a.unit))]):t._e()],1)])}),t._v(" "),e("button",{staticClass:"btn btn-transform btn-apply-size",attrs:{disabled:t.storageFormDisabled}},[t._v(t._s(t.$t("parameter.apply")))])],2)],1)]),t._v(" "),e("el-dialog",{ref:"selectDialog",staticClass:"path-dialog",attrs:{visible:t.selectPathData.visible,title:t.$t("parameter.selectDiskPath")},on:{"update:visible":function(a){t.$set(t.selectPathData,"visible",a)},close:t.selectPathData.close}},[e("div",{staticClass:"dialog-body clearfix"},[e("div",{staticClass:"path-panel"},[e("span",[t._v(t._s(t.$t("parameter.selectPath")))]),t._v(" "),e("div",{staticClass:"path-select-panel"},t._l(t.selectPathData.data,function(a){return e("div",{on:{click:function(e){t.changeSelected(a)}}},[e("span",[a.subDisks?t._e():e("span",{class:[a.subDisks?"":"no-child-folder"]}),t._v(" "),a.subDisks&&a.isOpen?e("i",{staticClass:"fa fa-caret-down folder-icon"}):t._e(),t._v(" "),a.subDisks&&!a.isOpen?e("i",{staticClass:"fa fa-caret-right folder-icon"}):t._e(),t._v(" "),e("el-checkbox",{attrs:{checked:a.isSelected,indeterminate:a.isIndeterminate},on:{change:function(e){t.firstPathChange(a)}},model:{value:a.isSelected,callback:function(e){t.$set(a,"isSelected",e)},expression:"row.isSelected"}}),t._v(" "),e("i",{staticClass:"fa fa-folder text-folder"}),t._v(" "),e("span",{staticClass:"folder-name m-l-xs"},[t._v(t._s(a.path))])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:a.subDisks&&a.isOpen,expression:"row.subDisks && row.isOpen"}],staticClass:"m-l-lg"},t._l(a.subDisks,function(s){return e("span",[e("el-checkbox",{attrs:{checked:s.isSelected},on:{change:function(e){t.childPathChange(s,a)}},model:{value:s.isSelected,callback:function(a){t.$set(s,"isSelected",a)},expression:"child.isSelected"}}),t._v(" "),e("i",{staticClass:"fa fa-folder text-folder"}),t._v(" "),e("span",{staticClass:"folder-name m-l-xs"},[t._v(t._s(s.path))]),e("br")],1)}))])})),t._v(" "),e("span",[t._v(t._s(t.$t("parameter.selectedPath")))]),t._v(" "),e("div",{staticClass:"path-selected-panel"},t._l(t.data.fileSystemPathDialog,function(a){return e("span",{key:a},[t._v(t._s(a)),e("br")])}))])]),t._v(" "),e("div",{staticClass:"dialog-footer"},[e("el-button",{staticClass:"btn btn-gradient btn-sm",on:{click:t.selectPathData.confirm}},[t._v(t._s(t.$t("common.confirm")))]),t._v(" "),e("el-button",{staticClass:"btn btn-transparent btn-sm",on:{click:t.selectPathData.close}},[t._v(t._s(t.$t("common.cancel")))])],1)])],1)},staticRenderFns:[]};var u=e("VU/8")(d,p,!1,function(t){e("VymN")},"data-v-437b7a25",null),m=e("dV33");m&&m.__esModule&&(m=m.default),"function"==typeof m&&m(u);a.default=u.exports},VymN:function(t,a){},dV33:function(t,a){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh":{"parameter":{"title":"参数配置","apply":"应用","selectPath":"选择路径","selectedPath":"已选路径","selectDiskPath":"选择挂载路径","initDeploy":"存储卷初始化配置","capacity":"存储卷容量","initInfo":"设置个人网盘存储卷的挂载路径、文件系统类型","path":"存储卷挂载路径","fileSystemTypes":"文件系统类型","personalStorage":"个人网盘配额","quota":"个人网盘配额","storageInfo":"设置每个用户个人网盘总空间大小","modifySuccess":"应用配置成功"}}}')}}});
//# sourceMappingURL=8.761828f2f04e47647389.js.map